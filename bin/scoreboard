#!/usr/bin/env php
<?php

require_once __DIR__ . '/../vendor/autoload.php';

class Main
{
    private $tennisScoreBoard;
    private $score;

    public function __construct(ScoreBoard $tennisScoreBoard, Score $score)
    {
        $this->tennisScoreBoard = $tennisScoreBoard;
        $this->score = $score;
    }

    public function run()
    {
        $this->score->playerScored(rand(0, 1));
        $formattedScore = $this->score->getFormattedScoreForScoreBoard($this->tennisScoreBoard);

        if ($formattedScore !== 'Game') {
            echo "\033[01;33m" . $formattedScore . "\n\033[0m\n";
            return $this->run();
        }

        echo "\033[01;32m" . $formattedScore . "\n\033[0m";
        echo("Well done!!!\n");
    }

}

$tennisScoreBoard = new TennisScoreBoard();
$tennisScore = new TennisScore();

$game = new Main($tennisScoreBoard, $tennisScore);
$game->run();

